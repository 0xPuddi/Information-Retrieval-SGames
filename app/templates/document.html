<!DOCTYPE html>
<html>
	<head>
		<title>SGames</title>

		<link
			rel="stylesheet"
			href="{{ url_for('static', filename='output.css') }}"
		/>

		<link
			rel="icon"
			href="{{ url_for('static', filename='gameboy-white.svg') }}"
			media="(prefers-color-scheme: light)"
		/>
		<link
			rel="icon"
			href="{{ url_for('static', filename='gameboy-dark.svg') }}"
			media="(prefers-color-scheme: dark)"
		/>
		<link
			rel="icon"
			href="{{ url_for('static', filename='gameboy-white.svg') }}"
		/>

		<script
			defer
			src="{{ url_for('static', filename='document.js') }}"
		></script>

		<link
			href="//vjs.zencdn.net/8.23.4/video-js.min.css"
			rel="stylesheet"
		/>
		<script src="//vjs.zencdn.net/8.23.4/video.min.js"></script>
	</head>

	<body class="bg-gray-100 py-14 px-2 flex items-center justify-center">
		<div
			class="w-screen min-h-screen px-4 lg:max-w-8/12 flex items-center justify-start"
		>
			<div
				class="bg-gray-100! flex flex-col gap-10 relative items-center justify-center w-full"
			>
				<div class="absolute top-0 right-0">
					<a href="{{ d.source.url }}" target="_blank">
						<button
							class="click p-3 rounded-xl bg-blue-900 hover:bg-blue-400 cursor-pointer transition-all shadow-md flex items-center justify-center"
						>
							<img
								src="{{ url_for('static', filename='ui/export.svg') }}"
								class="w-6 h-6"
							/>
						</button>
					</a>
				</div>

				<div class="flex w-full items-center justify-start gap-6">
					<h1 class="text-4xl font-semibold text-gray-900">
						{{ d.metadata.title }}
					</h1>

					<div class="flex items-center justify-center gap-2">
						{% if d.metadata.platforms is iterable and d.metadata is
						not string %} {% for p in d.metadata.platforms %} {% if
						p == "windows" %}
						<img
							src="{{ url_for('static', filename='platforms/windows.svg') }}"
							class="w-6 h-6 fill-gray-500"
						/>
						{% elif p == "linux" %}
						<img
							src="{{ url_for('static', filename='platforms/linux.svg') }}"
							class="w-6 h-6 fill-gray-500"
						/>
						{% elif p == "mac" %}
						<img
							src="{{ url_for('static', filename='platforms/apple.svg') }}"
							class="w-6 h-6 fill-gray-500"
						/>
						{% elif p == "html5" %}
						<img
							src="{{ url_for('static', filename='platforms/html5.svg') }}"
							class="w-6 h-6 fill-gray-500"
						/>
						{% elif p == "android" %}
						<img
							src="{{ url_for('static', filename='platforms/android.svg') }}"
							class="w-6 h-6 fill-gray-500"
						/>
						{% endif %} {% endfor %} {% endif %}
					</div>
				</div>

				<div
					class="flex flex-row items-center justify-start gap-4 w-full"
				>
					<div
						class="bg-primary-blue shadow-xl flex items-center justify-center rounded-2xl py-1 px-2"
					>
						<p class="text-md text-white space-y-1">
							{{ d.metadata.author }}
						</p>
					</div>

					<div
						class="bg-primary-blue shadow-xl flex items-center justify-center rounded-2xl py-1 px-2"
					>
						<p class="text-md text-white space-y-1">
							{{ d.metadata.category }}
						</p>
					</div>

					<div
						class="bg-primary-blue shadow-xl flex items-center justify-center rounded-2xl py-1 px-2"
					>
						<p class="text-md text-white space-y-1">
							{{ d.metadata.status }}
						</p>
					</div>
				</div>

				<div
					class="flex flex-wrap gap-2 items-center justify-start w-full"
				>
					{% if d.metadata and d.metadata.tags is iterable %} {% for
					tag in d.metadata.tags %}
					<span
						class="bg-blue-100 text-black px-2 py-1 rounded-lg flex items-center text-xs"
					>
						{{ tag }}
					</span>
					{% endfor %} {% endif %}
				</div>

				{% if d.metadata and d.metadata.videos is iterable %}
				<div
					class="flex flex-col items-center justify-center gap-5 w-full"
				>
					<div
						class="flex items-center justify-start w-full border-b border-primary-blue"
					>
						<h3 class="text-2xl font-semibold text-gray-600">
							Videos
						</h3>
					</div>

					<div
						class="flex items-center justify-start gap-5 w-full max-w-4xl max-h-36 overflow-x-scroll rounded-lg bg-gray-200"
					>
						{% for url in d.metadata.videos %} {% if
						"youtube.com/embed" in url %}
						<div
							class="shadow-2xl border border-primary-blue h-32 w-64 shrink-0"
						>
							<iframe
								width="100%"
								height="100%"
								src="{{ url }}"
								frameborder="0"
								allow="accelerometer; clipboard-write; encrypted-media; picture-in-picture; web-share"
								allowfullscreen
							></iframe>
						</div>
						{% elif ".m3u8" in url %}
						<div
							class="shadow-2xl border border-primary-blue h-32 w-64 shrink-0"
						>
							<video
								id="video-{{ loop.index0 }}"
								class="video-js vjs-default-skin vjs-fill"
								controls
								preload="none"
								width="100%"
								height="100%"
								data-setup="{}"
								poster="{{ d.metadata.images[loop.index0] or d.metadata.images[0] }}"
							>
								<source
									src="{{ url }}"
									type="application/x-mpegURL"
								/>
								<p class="vjs-no-js">
									To view this video please enable JavaScript,
									and consider upgrading to a web browser that
									<a
										href="https://videojs.com/html5-video-support/"
										target="_blank"
									>
										supports HTML5 video
									</a>
								</p>
							</video>
						</div>
						{% endif %} {% endfor %}
					</div>
				</div>
				{% endif %} {% if d.metadata and d.metadata.images is iterable
				%}
				<div
					class="flex flex-col items-center justify-center gap-5 w-full"
				>
					<div
						class="flex items-center justify-start w-full border-b border-primary-blue"
					>
						<h3 class="text-2xl font-semibold text-gray-600">
							Images
						</h3>
					</div>

					<div
						class="flex items-center justify-start gap-5 w-full max-w-4xl max-h-36 overflow-x-scroll rounded-lg bg-gray-200"
					>
						{% for image in d.metadata.images %}
						<div
							class="shadow-2xl border border-primary-blue h-32 w-64 shrink-0 cursor-pointer"
						>
							<img
								src="{{ image }}"
								alt="{{ loop.index0 }} image"
								class="w-full h-full object-cover"
								onerror="this.src = FALLBACK_IMAGE_URL;"
							/>
						</div>
						{% endfor %}
					</div>
				</div>
				{% endif %} {% if d.metadata and d.metadata.price %}
				<div
					class="flex flex-col items-center justify-center gap-5 w-full"
				>
					<div
						class="flex items-center justify-start w-full border-b border-primary-blue"
					>
						<h3 class="text-2xl font-semibold text-gray-600">
							Offers
						</h3>
					</div>

					<div
						class="flex flex-wrap gap-2 w-full items-center justify-start"
					>
						{% if d.metadata.price is not string and
						d.metadata.price is sequence %} {% for prices in
						d.metadata.price %} {% for title, price in
						prices.items() %}
						<div
							class="bg-primary-blue shadow flex flex-col items-center justify-start rounded-md py-2 px-3"
						>
							<p class="text-md text-white space-y-1">
								{{ title }}
							</p>
							<p class="text-md text-white space-y-1">
								{% if d.metadata.price is number %} {{ price }}
								$ {% else %} {{ price }} {% endif %}
							</p>
						</div>
						{% endfor %} {% endfor %} {% elif d.metadata.price is
						string %}
						<div
							class="bg-primary-blue shadow flex items-center justify-center rounded-md py-2 px-3"
						>
							<p class="text-md text-white space-y-1">
								{{ d.metadata.price }}
							</p>
						</div>
						{% elif d.metadata.price is number %}
						<div
							class="bg-primary-blue shadow flex items-center justify-center rounded-md py-2 px-3"
						>
							<p class="text-md text-white space-y-1">
								{{ d.metadata.price }} $
							</p>
						</div>
						{% endif %}
					</div>
				</div>
				{% endif %}

				<div
					class="flex flex-col items-center justify-center gap-5 w-full"
				>
					<div
						class="flex items-center justify-start w-full border-b border-primary-blue"
					>
						<h3 class="text-2xl font-semibold text-gray-600">
							Description
						</h3>
					</div>

					<div
						class="w-10/12 px-4 overflow-hidden bg-blue-100 rounded-t-lg py-3"
					>
						{{ d.metadata.description | safe }}
					</div>
				</div>

				<div class="absolute bottom-2 right-2">
					{% if d.source and d.source.name %}
					<img
						src="{{ url_for('static', filename='ui/') }}{{ d.source.name }}.svg"
						alt="{{ d.source.name }} logo"
						class="w-10 h-10 opacity-70"
					/>
					{% endif %}
				</div>
			</div>
		</div>
	</body>
</html>
